(self.webpackChunkreact_autosync_height=self.webpackChunkreact_autosync_height||[]).push([[179],{"./storybook/stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{DynamicChangeOfTheContent_ChildRerender:()=>DynamicChangeOfTheContent_ChildRerender,DynamicChangeOfTheContent_ChildrenHasReactAutosyncHeight:()=>DynamicChangeOfTheContent_ChildrenHasReactAutosyncHeight,DynamicChangeOfTheContent_Rerender:()=>DynamicChangeOfTheContent_Rerender,ExampleFromReadme:()=>ExampleFromReadme,default:()=>stories});var react=__webpack_require__("./node_modules/react/index.js"),objectSpread2=__webpack_require__("./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),classCallCheck=__webpack_require__("./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),createClass=__webpack_require__("./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass.js"),react_dom=__webpack_require__("./node_modules/react-dom/index.js"),MyMutationObserver=function(){function MyMutationObserver(el,onMutation,config){var _this=this;(0,classCallCheck.Z)(this,MyMutationObserver),this.observer=void 0,this.el=void 0,this.onMutation=void 0;var node=react_dom.findDOMNode(el);null!==node&&(this.el=el,this.onMutation=onMutation,this.observer=new MutationObserver((function(mutations){return mutations.forEach(_this.mutationReducer.bind(_this))})),this.observer.observe(node,config))}return(0,createClass.Z)(MyMutationObserver,[{key:"disconnect",value:function disconnect(){}},{key:"mutationReducer",value:function mutationReducer(payload){switch(payload.type){case"attributes":return this.handleAttributes(payload);case"characterData":return this.handleCharacterData(payload);case"childList":return this.handleChildList(payload)}}},{key:"handleAttributes",value:function handleAttributes(payload){var _getAttribute,oldValue=payload.oldValue,target=payload.target,attributeName=payload.attributeName,attributeNamespace=payload.attributeNamespace,res={from:null!=oldValue?oldValue:void 0,to:attributeName&&null!==(_getAttribute=target.getAttribute(attributeName))&&void 0!==_getAttribute?_getAttribute:void 0,name:null!=attributeName?attributeName:void 0,namespace:null!=attributeNamespace?attributeNamespace:void 0,target};this.onMutation("attributes",res)}},{key:"handleCharacterData",value:function handleCharacterData(payload){var oldValue=payload.oldValue,target=payload.target,res={from:null!=oldValue?oldValue:void 0,to:target.data,target};this.onMutation("characterData",res)}},{key:"handleChildList",value:function handleChildList(payload){var _this2=this,addedNodes=payload.addedNodes,nextSibling=payload.nextSibling,previousSibling=payload.previousSibling,removedNodes=payload.removedNodes,res={target:payload.target,previousSibling:null!=previousSibling?previousSibling:void 0,nextSibling:null!=nextSibling?nextSibling:void 0,wrappedNode:this.el};addedNodes.length>0&&Array.from(addedNodes).forEach((function(child){_this2.onMutation("childAdded",(0,objectSpread2.Z)((0,objectSpread2.Z)({},res),{},{child}))})),removedNodes.length>0&&Array.from(removedNodes).forEach((function(child){_this2.onMutation("childRemoved",(0,objectSpread2.Z)((0,objectSpread2.Z)({},res),{},{child}))}))}}],[{key:"buildConfig",value:function buildConfig(props){var _props$attributeList=props.attributeList,attributeList=void 0===_props$attributeList?[]:_props$attributeList,categories=props.categories,suppressAttributeOldValue=props.suppressAttributeOldValue,suppressCharacterDataOldValue=props.suppressCharacterDataOldValue,subtree=props.subtree,cats=MyMutationObserver.getCategories(categories);return{attributes:cats.indexOf("attributes")>-1,characterData:cats.indexOf("characterData")>-1,childList:cats.indexOf("childList")>-1,attributeFilter:attributeList.length>0&&cats.indexOf("attributes")>-1?attributeList:void 0,attributeOldValue:!1===suppressAttributeOldValue&&cats.indexOf("attributes")>-1,characterDataOldValue:!1===suppressCharacterDataOldValue&&cats.indexOf("characterData")>-1,subtree}}},{key:"getCategories",value:function getCategories(categories){return"ALL_CATEGORIES"===categories?["attributes","characterData","childList"]:"string"==typeof categories?[categories]:categories}}]),MyMutationObserver}(),cache={};function getFromCache(id){return cache[id]}function findAndApplyHeight(id,el,debug){if(el){if(0!==el.offsetHeight){var elements=getFromCache(id),maxHeight=0;elements.forEach((function(el){maxHeight=function getMaximumHeight(maxHeight,el){var elHeight=function getElementHeight(el){var box=el.getBoundingClientRect();return Math.ceil(box.height)}(el);return Math.max(maxHeight,elHeight)}(maxHeight,el)}));var count=0;if(elements.forEach((function(el){var prevHeight=el.dataset.prevHeight;if(delete el.dataset.prevHeight,el.style.height!==prevHeight){var newHeight="".concat(maxHeight,"px");el.style.height!==newHeight&&(el.setAttribute("style","height:".concat(newHeight)),count++)}})),debug&&count>0){var msg="[ReactAutosyncHeight] ".concat(id," : ").concat(maxHeight,"px (applied to ").concat(count," element").concat(1===count?"":"s",")");console.info(msg)}return maxHeight}setTimeout((function(){return findAndApplyHeight(id,el,debug)}),100)}}const src_ReactAutosyncHeight=function ReactAutosyncHeight(props){var children=props.children,_props$debug=props.debug,debug=void 0!==_props$debug&&_props$debug,id=props.id,elRef=react.useRef(),observerRef=react.useRef(),handleResize=react.useCallback((function(el){"auto"!==el.style.height&&(getFromCache(id).forEach((function(el){"auto"!==el.style.height&&(el.dataset.prevHeight=el.style.height,el.setAttribute("style","height:auto"))})),requestAnimationFrame((function(){return findAndApplyHeight(id,el,debug)})))}),[debug,id]),handleMutation=react.useCallback((function(type,payload){var el=elRef.current;"attributes"===type&&payload.target===el||void 0!==el&&handleResize(el)}),[handleResize]),handleRef=react.useCallback((function(el){null!==el&&(!function addToCache(id,el){if(!el)return;void 0===cache[id]&&(cache[id]=[]);cache[id].push(el)}(id,el),findAndApplyHeight(id,el,debug),elRef.current=el,handleResize(el),observerRef.current=new MyMutationObserver(el,handleMutation,MyMutationObserver.buildConfig({categories:"ALL_CATEGORIES",subtree:!0})))}),[handleMutation,handleResize,debug,id]);return react.useEffect((function(){return function(){var _observerRef$current;null===(_observerRef$current=observerRef.current)||void 0===_observerRef$current||_observerRef$current.disconnect(),elRef.current&&function removeFromCache(id,el){cache[id]=cache[id].filter((function(e){return e!==el}))}(id,elRef.current)}}),[id]),react.createElement("div",{"data-cy":"ReactAutosyncHeight","data-react-autosync-height":id,ref:handleRef},children)};var slicedToArray=__webpack_require__("./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),StorybookComponent=function StorybookComponent(props){var color=props.color,id=props.id,speed=props.speed,initialNumRows=(0,react.useMemo)((function(){return Math.ceil(5*Math.random())+1}),[]),_useState=(0,react.useState)(initialNumRows),_useState2=(0,slicedToArray.Z)(_useState,2),numRows=_useState2[0],setNumRows=_useState2[1],count=(0,react.useRef)(0);(0,react.useEffect)((function(){var timeout=function setIntervalX(callback,delay,repetitions,meta){var x=0,intervalId=setInterval((function(){callback(intervalId),++x>=repetitions&&clearInterval(intervalId)}),delay);return intervalId}((function(){return setNumRows((function(prevNumRows){return prevNumRows<2?prevNumRows+1:prevNumRows>=25?prevNumRows-1:(count.current++,count.current<=5?prevNumRows+1:prevNumRows-1)}))}),1e3*speed,10);return function(){return clearInterval(timeout)}}),[count,speed]);var renderText=(0,react.useCallback)((function(){for(var rows=[],i=0;i<numRows;i++)rows.push("Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua.");return rows.join("\n")}),[numRows]);return react.createElement(src_ReactAutosyncHeight,{id},react.createElement("div",{style:{backgroundColor:color}},id,". ",renderText()))};var DynamicComponent=function DynamicComponent(props){var color=props.color,id=props.id,speed=props.speed,initialNumRows=(0,react.useMemo)((function(){return Math.ceil(5*Math.random())+1}),[]),_useState=(0,react.useState)(initialNumRows),_useState2=(0,slicedToArray.Z)(_useState,2),numRows=_useState2[0],setNumRows=_useState2[1],count=(0,react.useRef)(0);(0,react.useEffect)((function(){var timeout=function DynamicComponent_setIntervalX(callback,delay,repetitions,meta){var x=0,intervalId=setInterval((function(){callback(intervalId),++x>=repetitions&&clearInterval(intervalId)}),delay);return intervalId}((function(){return setNumRows((function(prevNumRows){return prevNumRows<2?prevNumRows+1:prevNumRows>=25?prevNumRows-1:(count.current++,count.current<=5?prevNumRows+1:prevNumRows-1)}))}),1e3*speed,10);return function(){return clearInterval(timeout)}}),[count,speed]);var renderText=(0,react.useCallback)((function(){for(var rows=[],i=0;i<numRows;i++)rows.push("Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua.");return rows.join("\n")}),[numRows]);return react.createElement("div",{style:{backgroundColor:color}},id,". ",renderText())};var StaticComponent=function StaticComponent(props){var color=props.color,id=props.id,speed=props.speed;return react.createElement(src_ReactAutosyncHeight,{id},react.createElement(DynamicComponent,{id,color,speed}))},style={display:"grid",gridTemplateColumns:"repeat(2, minmax(300px ,500px))"},styleColumn={border:"solid 2px grey"};const stories={title:"ReactAutosyncHeight",component:src_ReactAutosyncHeight};var ExampleFromReadme=function ExampleFromReadme(){return react.createElement("div",{style},react.createElement("div",{id:"Column1"},react.createElement(src_ReactAutosyncHeight,{id:"Section1"},"1. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua."),react.createElement(src_ReactAutosyncHeight,{id:"Section2"},"2. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua."),react.createElement(src_ReactAutosyncHeight,{id:"Section3"},"3. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua.")),react.createElement("div",{id:"Column2"},react.createElement(src_ReactAutosyncHeight,{id:"Section1"},"1. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet."),react.createElement(src_ReactAutosyncHeight,{id:"Section2"},"2. Lorem ipsum dolor sit amet, consetetur sadipscing elitr."),react.createElement(src_ReactAutosyncHeight,{id:"Section3"},"3. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua.")))};ExampleFromReadme.storyName="Example from Readme";var DynamicChangeOfTheContent_Rerender=function DynamicChangeOfTheContent_Rerender(){return react.createElement("div",{style},react.createElement("div",{id:"Column1"},react.createElement(StorybookComponent,{id:"Section1",speed:2,color:"aqua"}),react.createElement(StorybookComponent,{id:"Section2",speed:.5,color:"antiquewhite"}),react.createElement(StorybookComponent,{id:"Section3",speed:1,color:"aliceblue"})),react.createElement("div",{id:"Column2"},react.createElement(StorybookComponent,{id:"Section1",speed:1,color:"aqua"}),react.createElement(StorybookComponent,{id:"Section2",speed:1,color:"antiquewhite"}),react.createElement(StorybookComponent,{id:"Section3",speed:.4,color:"aliceblue"})))};DynamicChangeOfTheContent_Rerender.storyName="Dynamic change of the content (re-render)";var DynamicChangeOfTheContent_ChildRerender=function DynamicChangeOfTheContent_ChildRerender(){return react.createElement("div",{style},react.createElement("div",{id:"Column1"},react.createElement(StaticComponent,{id:"Section1",speed:2,color:"aqua"}),react.createElement(StaticComponent,{id:"Section2",speed:.5,color:"antiquewhite"}),react.createElement(StaticComponent,{id:"Section3",speed:1,color:"aliceblue"})),react.createElement("div",{id:"Column2"},react.createElement(StaticComponent,{id:"Section1",speed:1,color:"aqua"}),react.createElement(StaticComponent,{id:"Section2",speed:1,color:"antiquewhite"}),react.createElement(StaticComponent,{id:"Section3",speed:.4,color:"aliceblue"})))};DynamicChangeOfTheContent_ChildRerender.storyName="Dynamic change of the content (child re-render)";var DynamicChangeOfTheContent_ChildrenHasReactAutosyncHeight=function DynamicChangeOfTheContent_ChildrenHasReactAutosyncHeight(){return react.createElement("div",{style},react.createElement(src_ReactAutosyncHeight,{id:"Column",debug:!0},react.createElement("div",{style:styleColumn},react.createElement(StaticComponent,{id:"Section1",speed:2,color:"aqua"}),react.createElement(StaticComponent,{id:"Section2",speed:.5,color:"antiquewhite"}),react.createElement(StaticComponent,{id:"Section3",speed:1,color:"aliceblue"}))),react.createElement(src_ReactAutosyncHeight,{id:"Column"},react.createElement("div",{style:styleColumn},react.createElement(StaticComponent,{id:"Section1",speed:1,color:"aqua"}),react.createElement(StaticComponent,{id:"Section2",speed:1,color:"antiquewhite"}),react.createElement(StaticComponent,{id:"Section3",speed:.4,color:"aliceblue"}))))};DynamicChangeOfTheContent_ChildrenHasReactAutosyncHeight.storyName="Dynamic change of the content (children has ReactAutosyncHeight)"},"./storybook-init-framework-entry.js":(__unused_webpack_module,__unused_webpack___webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__("./node_modules/@storybook/react/dist/esm/client/index.js")},"./storybook sync ^\\.[\\\\/](?:stories\\.tsx)$":(module,__unused_webpack_exports,__webpack_require__)=>{var map={"./stories.tsx":"./storybook/stories.tsx"};function webpackContext(req){var id=webpackContextResolve(req);return __webpack_require__(id)}function webpackContextResolve(req){if(!__webpack_require__.o(map,req)){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}return map[req]}webpackContext.keys=function webpackContextKeys(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id="./storybook sync ^\\.[\\\\/](?:stories\\.tsx)$"},"?4f7e":()=>{},"./generated-stories-entry.cjs":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";module=__webpack_require__.nmd(module),(0,__webpack_require__("./node_modules/@storybook/react/dist/esm/client/index.js").configure)([__webpack_require__("./storybook sync ^\\.[\\\\/](?:stories\\.tsx)$")],module,!1)}},__webpack_require__=>{var __webpack_exec__=moduleId=>__webpack_require__(__webpack_require__.s=moduleId);__webpack_require__.O(0,[670],(()=>(__webpack_exec__("./node_modules/@storybook/core-client/dist/esm/globals/polyfills.js"),__webpack_exec__("./node_modules/@storybook/core-client/dist/esm/globals/globals.js"),__webpack_exec__("./storybook-init-framework-entry.js"),__webpack_exec__("./generated-stories-entry.cjs"))));__webpack_require__.O()}]);